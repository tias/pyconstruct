

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Learners &mdash; Pyconstruct 0.1.11 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="Pyconstruct 0.1.11 documentation" href="../../index.html"/>
        <link rel="up" title="Reference Manual" href="../index.html"/>
        <link rel="next" title="pyconstruct.learners.BaseLearner" href="generated/pyconstruct.learners.BaseLearner.html"/>
        <link rel="prev" title="pyconstruct.domains.MiniZincDomain.n_features" href="../domains/generated/pyconstruct.domains.MiniZincDomain.n_features.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Pyconstruct
          

          
          </a>

          
            
            
              <div class="version">
                0.1.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../structured.html">Structured prediction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Reference Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../datasets/index.html">Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../domains/index.html">Domains</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Learners</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pyconstruct.learners.BaseLearner.html">pyconstruct.learners.BaseLearner</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pyconstruct.learners.BaseSSG.html">pyconstruct.learners.BaseSSG</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pyconstruct.learners.SSG.html">pyconstruct.learners.SSG</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pyconstruct.learners.EG.html">pyconstruct.learners.EG</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pyconstruct.learners.StructuredPerceptron.html">pyconstruct.learners.StructuredPerceptron</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pyconstruct.learners.BlockCoordinateFrankWolfe.html">pyconstruct.learners.BlockCoordinateFrankWolfe</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../metrics/index.html">Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/index.html">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html">Utilities</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Pyconstruct</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Reference Manual</a> &raquo;</li>
        
      <li>Learners</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/reference/learners/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="learners">
<h1>Learners<a class="headerlink" href="#learners" title="Permalink to this headline">¶</a></h1>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="generated/pyconstruct.learners.BaseLearner.html#pyconstruct.learners.BaseLearner" title="pyconstruct.learners.BaseLearner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseLearner</span></code></a>([domain,&nbsp;model])</td>
<td>A basic learning model class.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/pyconstruct.learners.BaseSSG.html#pyconstruct.learners.BaseSSG" title="pyconstruct.learners.BaseSSG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseSSG</span></code></a>([domain,&nbsp;model,&nbsp;inference,&nbsp;alpha,&nbsp;…])</td>
<td>Base implementation of a learner with the subgradient algorithm.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/pyconstruct.learners.SSG.html#pyconstruct.learners.SSG" title="pyconstruct.learners.SSG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SSG</span></code></a>([domain,&nbsp;model,&nbsp;inference,&nbsp;eta0,&nbsp;…])</td>
<td>Learner implementing the standard subgradient algorithm.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/pyconstruct.learners.EG.html#pyconstruct.learners.EG" title="pyconstruct.learners.EG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EG</span></code></a>([domain,&nbsp;model,&nbsp;inference,&nbsp;eta0,&nbsp;…])</td>
<td>Learner implementing the Exponentiate Gradient algorithm.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="generated/pyconstruct.learners.StructuredPerceptron.html#pyconstruct.learners.StructuredPerceptron" title="pyconstruct.learners.StructuredPerceptron"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StructuredPerceptron</span></code></a>([domain,&nbsp;model])</td>
<td>A simple structured perceptron algorithm from <a href="#id3"><span class="problematic" id="id1">[1]_</span></a>.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="generated/pyconstruct.learners.BlockCoordinateFrankWolfe.html#pyconstruct.learners.BlockCoordinateFrankWolfe" title="pyconstruct.learners.BlockCoordinateFrankWolfe"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BlockCoordinateFrankWolfe</span></code></a>([domain,&nbsp;model,&nbsp;…])</td>
<td>Learner using the Block-Coordinate Frank-Wolfe algorithm <a href="#id4"><span class="problematic" id="id2">[1]_</span></a>.</td>
</tr>
</tbody>
</table>
<span class="target" id="module-pyconstruct.learners"></span><p>This package contains several learning algorithms to be used in conjunction with
Pyconstruct domains. All the learners in Pyconstruct are agnostic to the type of
structured objects the data contains, thanks to the fact that the domain takes
care of making inference in a generic way.</p>
<p>Here we use the “equations” example, available in the <a class="reference external" href="https://github.com/unitn-sml/pyconstruct">source code</a>, to show how Pyconstruct learners
can be used.</p>
<p>Learners in Pyconstruct follow the same interface as Scikit-learn estimators.
Each learner needs first to be instanciated, passing a domain as argument to the
constructor. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyconstruct</span> <span class="k">import</span> <span class="n">SSG</span><span class="p">,</span> <span class="n">Domain</span>

<span class="n">eq</span> <span class="o">=</span> <span class="n">Domain</span><span class="p">(</span><span class="s1">&#39;equations.pmzn&#39;</span><span class="p">)</span>
<span class="n">ssg</span> <span class="o">=</span> <span class="n">SSG</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we used <a class="reference internal" href="generated/pyconstruct.learners.SSG.html#pyconstruct.learners.SSG" title="pyconstruct.learners.SSG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SSG</span></code></a>, which is a learner using the stochastic subgradient method.
A learner must be initialized with either a domain or an existing model
containing a domain. If only a domain is passed, then the default model for the
learner is used (a <em class="xref py py-obj">LinearModel</em> in the case of <a class="reference internal" href="generated/pyconstruct.learners.SSG.html#pyconstruct.learners.SSG" title="pyconstruct.learners.SSG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SSG</span></code></a>). If a model is also
passed, it has to be compatible with the learner (<em class="xref py py-obj">LinearModel</em> or compatible
subclasses for <a class="reference internal" href="generated/pyconstruct.learners.SSG.html#pyconstruct.learners.SSG" title="pyconstruct.learners.SSG"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SSG</span></code></a>).</p>
<p>The constructor of the learner usually accepts other hyper-parameters of the
algorithm as well. After being instantiated, the learner needs to be trained
with data that is compatible with the domain passed to the learner instance. In
this case, for instance, we can make use of data provided by Pyconstruct:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyconstruct.datasets</span> <span class="k">import</span> <span class="n">load_equations</span>
<span class="n">equations</span> <span class="o">=</span> <span class="n">load_equations</span><span class="p">()</span>
</pre></div>
</div>
<p>Most of the learners in Pyconstruct are online learners, i.e. they can partially
fit a model a mini-batch of examples at the time. This provides high flexibility
to the way models can be trained, and is indeed useful given that training a
very big model on structured data may require a lot of time and computational
resources. As in Scikit-learn, online learners implement the <em class="xref py py-obj">partial_fit</em>
method, which takes a mini-batch of examples and uses it to update the model.
Pyconstruct has a convenient utility to separate data into mini-batches, which
in turn can then be used to train the model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyconstruct.utils</span> <span class="k">import</span> <span class="n">batches</span>

<span class="k">for</span> <span class="n">X_b</span><span class="p">,</span> <span class="n">Y_b</span> <span class="ow">in</span> <span class="n">batches</span><span class="p">(</span><span class="n">equations</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">equations</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">ssg</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">X_b</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">)</span>
</pre></div>
</div>
<p>This method of training is very flexible because it allows to, for instance,
validate the model while training:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyconstruct.metrics</span> <span class="k">import</span> <span class="n">hamming</span>

<span class="k">for</span> <span class="n">X_b</span><span class="p">,</span> <span class="n">Y_b</span> <span class="ow">in</span> <span class="n">batches</span><span class="p">(</span><span class="n">equations</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">equations</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>

    <span class="c1"># Validate</span>
    <span class="n">Y_pred</span> <span class="o">=</span> <span class="n">ssg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_b</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">hamming</span><span class="p">(</span><span class="n">Y_pred</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="s1">&#39;sequence&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Training loss: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loss</span><span class="p">))</span>

    <span class="c1"># Update</span>
    <span class="n">ssg</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">X_b</span><span class="p">,</span> <span class="n">Y_b</span><span class="p">)</span>
</pre></div>
</div>
<p>Here the <em class="xref py py-obj">hamming</em> function takes a parameter <em class="xref py py-obj">key=’sequence’</em> because that is
the name of the attribute in the equations data that need to be compared.</p>
<p>Learners also implement the <em class="xref py py-obj">fit</em> method, which divides the data in batches and
the uses the <em class="xref py py-obj">partial_fit</em>, as shown above.</p>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="generated/pyconstruct.learners.BaseLearner.html" class="btn btn-neutral float-right" title="pyconstruct.learners.BaseLearner" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../domains/generated/pyconstruct.domains.MiniZincDomain.n_features.html" class="btn btn-neutral" title="pyconstruct.domains.MiniZincDomain.n_features" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Paolo Dragone (MIT Licence).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1.11',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>